@*@model IEnumerable<Models.USP_GetTrainerAvailability_Result>*@
@model IEnumerable<Models.tblTrainerDetail>

<link href="~/Content/themes/base/jquery-ui.min.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.12.4.min.js"></script>
<script src="~/Scripts/jquery-ui-1.12.1.min.js"></script>

<b>List of Available Trainers</b>
@*@if (Model != null)
{*@
    <table border="1">
        <tr>
            <th style="text-align: center; background-color: rgb(204, 204, 204);">Trainer's Id</th>
            <th style="text-align: center; background-color: rgb(204, 204, 204);">Status</th>
            <th style="text-align: center; background-color: rgb(204, 204, 204);">Name</th>
            <th style="text-align: center; background-color: rgb(204, 204, 204);">Experience in Years</th>
            <th style="text-align: center; background-color: rgb(204, 204, 204);">Location</th>
        </tr>
        
                @foreach (Models.tblTrainerDetail item in Model)
                {
                <tr id="tblTrainer">
                    <td>@item.TrainerId</td>
                    <td><input type="button" value="Check Projection Status" class="btnStatus" style="color: white; background-color: rgb(153, 51, 255);" /></td>
                    <td>@item.TrainerName</td>
                    <td>@item.Experience</td>
                    <td>@item.Location</td>
                </tr>
            }
        <tr>
            <td id="message" style="color: rgb(153, 0, 51); font-weight: bold;"></td>
        </tr>
      
    </table>
@*}*@

<script type="text/javascript">
   $(function () {
       $(".btnStatus").click(function () {          
            if ($("#StartDate").val() == "" && $("#EndDate").val() == "") {
                alert("Please Select Start Date & End Date");
            }
            else if ($("#StartDate").val() == "") {
                alert("Please Select Start Date");
            }
            else if ($("#EndDate").val() == "") {
                alert("Please Select End Date");
            }
            else {
                var trainerId = $(this).closest("tr").find("td:first-child").text();
                var startDt = $('#StartDate').val();
                var dtArray1 = startDt.split("/");
                var startDate = dtArray1[1] + '/' + dtArray1[0] + '/' + dtArray1[2];
                var endDt = $('#EndDate').val();
                var dtArray2 = endDt.split("/");
                var endDate = dtArray2[1] + '/' + dtArray2[0] + '/' + dtArray2[2];

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetTrainers", "Home")',
                    data: { TrainerId: trainerId, StartDate: startDate, EndDate: endDate },
                    //contentType: "application/json",
                    //dataType: "json",
                    success: function (data) {
                        //$("#trainers").html(data);
                        $("#message").text(data);
                    }
                });
            }
        });
    });

</script>